package com.greedy.api.secion03.valid;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.MethodArgumentNotValidException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;

/* @ControllerAdvice : 컨트롤러를 보조해주는 기능을 제공한다는 것을 명시하는 어노테이션으로 
 * 해당 클래스내에 전역 예외처리를 등록할 수 있다. */
@ControllerAdvice
public class ExceptionController {

	@ExceptionHandler(UserNotFoundException.class)
	public  ResponseEntity<ErrorResponse> handleUserException(UserNotFoundException e){
		
		String code = "ERROR_CODE_00000";
		String description = "회원 정보 조회 실패";
		String detail = e.getMessage();
			
		return new ResponseEntity<>(
				new ErrorResponse(code, description,detail), HttpStatus.NOT_FOUND);
	}
	
	@ExceptionHandler(MethodArgumentNotValidException.class)
	public ResponseEntity<ErrorResponse> methodValidException(MethodArgumentNotValidException e){
		String code= "";
		String description = "";
		String detail = "";
		
		if(e.getBindingResult().hasErrors()) {
			detail = e.getBindingResult().getFieldError().getDefaultMessage();
			
			String bindResultcode = e.getBindingResult().getFieldError().getCode();
			
			switch(bindResultcode) {
			case "NotNull" : 
				code = "ERROR_CODE_0001";
				description = "필수값이 누락되었습니다. ";
			case "NotNull" : 
				code = "ERROR_CODE_0001";
				description = "필수값이 누락되었습니다. ";			
			case "NotNull" : 
				code = "ERROR_CODE_0001";
				description = "필수값이 누락되었습니다. ";				case "NotNull" : 
					code = "ERROR_CODE_0001";
					description = "필수값이 누락되었습니다. ";			}
		}
		
		return null;
	}
}
